# 勤怠管理表をつくり直した話

なにも特別なことではないが、月次で提出している勤怠管理表がある。
それはExcelで作られている。フォーマットには長年の血と汗の努力の形跡がある。
各行に時間の入力項目とタイムラインビュー(1時間ごとに区切り)がある。
出勤時間と退勤時間を入力すると、タイムラインビューに線(休憩時間を除く勤務時間のみ)が引かれる。

【これは非常に便利である。】

便利ではあるものの、線がうまく引かれないケースに対応する術がない、、
複雑なマクロと関数が仕込まれており、作った本人はもうそこにはいない。
当然、ドキュメントなんてない。

そのため、入力した退勤時間を一度消していた。
なぜか線が正しく引かれるから。

興味深い記事がある。
[なぜ「ネ申エクセル」は生まれたのか](https://www.itmedia.co.jp/news/articles/2203/31/news064.html)

デジタル(ここではExcelファイル)化の概要はだいたい、マニュアル作業を自動化するということだ。
紙に手書きしていた作業を、Excelファイルに入力するようにしただけ。

紙ならデザインを決めて、ペンでフォーマットをつくることが出来る。
それを印刷すれば、量産できる。

ただ、デジタルならどうか。
デザインを決めるところまでは、大きく変わらない。(試作のしやすさは大きく変わるだろうけど)
デザイン通りにつくるという点が大変なところだ。

ちなみに学生時代の恩師の口癖は「大変なときこそ、大きく変われる」だった。

複雑な勤怠表をどうつくり変えたか。
入力項目が多く、手間だったので入力を極力なくすというテーマを掲げた。
出勤/退勤ボタンでいいじゃないかと思ったのだが、以下の要件があったので見送った。
・入力を極力なくす(個人的な意志)
・勤務パターンがある
・休日は備考欄に休日と書かなければならない
・年に何回か休日の出勤もある
・複数案件(業務コード)ごとに勤務時間を集計したい(激ムズ)
・最大案件数は3つ

## 完成形

![完成形-案件1つのパラメータ]()
![完成形-案件1つの本シート]()

![完成形-案件複数のパラメータ]()
![完成形-案件複数の本シート]()


「パラメータ」シートには、キーと勤務パターン、業務コード、業務名を書く。
「パラメータ」シートの参画に○の数によって案件数を判定している。

案件数に応じて、本シートのフォーマットが変わる
本シートの最大の特徴はキーだ。
「パラメータ」シートに設定した勤務パターンをキーで引っ張る。

キーの入力とenterキーの2タイプで1日の勤怠入力ができる。